<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UkrYama Reference: YiiMailer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UkrYama Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Створено системою Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Пошук');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Пошук');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="class_yii_mailer.html">YiiMailer</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="namespace_yii.html">Yii</a> extension for sending emails with layouts using <a href="https://github.com/PHPMailer/PHPMailer">PHPMailer</a></p>
<h2>Features</h2>
<ul>
<li>Based on latest <a class="el" href="class_p_h_p_mailer.html">PHPMailer</a> (version 5.2.8 bundled)</li>
<li>Supports <a class="el" href="namespace_yii.html">Yii</a> layouts and translation</li>
<li>Supports web and console applications</li>
<li>Send full HTML emails with embedded images</li>
<li>Work with views like you usually do in <a class="el" href="namespace_yii.html">Yii</a></li>
<li>Use test mode to save emails instead of sending them (useful when you don't have mail server installed locally)</li>
</ul>
<h2>Installation</h2>
<ol type="1">
<li>Copy <a class="el" href="class_yii_mailer.html">YiiMailer</a> folder to protected/extensions</li>
<li>Add 'ext.YiiMailer.YiiMailer' line to your imports in main and/or console yii config</li>
<li>Copy mail.php config file to protected/config or add configuration array in 'params' under the key '<a class="el" href="class_yii_mailer.html">YiiMailer</a>'</li>
<li>Create email layout file mail.php in protected/views/layouts/ (default path, can be changed in config)</li>
<li>Create all the views you want to use in protected/views/mail/ (default path, can be changed in config)</li>
<li>Put all images you want to embed in emails in images/mail/ (default path, can be changed in config)</li>
</ol>
<h3>Note</h3>
<p>In console apps, alias 'webroot' may not be the same as in web apps. See <a href="https://github.com/yiisoft/yii/issues/1267">https://github.com/yiisoft/yii/issues/1267</a>. Best workaround is to set alias you need directly in config/console.php, e.g.: </p><pre>
Yii::setPathOfAlias('webroot.images.mail', '/path/to/your/images/mail/dir');
</pre><p>Yet another solution is to override protected/yiic.php and set 'webroot' alias there (see example files).</p>
<h2>Usage</h2>
<p>Instantiate <a class="el" href="class_yii_mailer.html">YiiMailer</a> in your controller or console command and pass view and data array: </p><pre>
$mail = new <a class="el" href="class_yii_mailer.html">YiiMailer</a>('contact', array('message' =&gt; 'Message to send', 'name' =&gt; 'John Doe', 'description' =&gt; 'Contact form'));
</pre><p> or </p><pre>
$mail = new <a class="el" href="class_yii_mailer.html">YiiMailer()</a>;
$mail-&gt;setView('contact');
$mail-&gt;setData(array('message' =&gt; 'Message to send', 'name' =&gt; 'John Doe', 'description' =&gt; 'Contact form'));
</pre><p> Layout is automatically set from config but you may override it with </p><pre>
$mail-&gt;setLayout('layoutName');
</pre><p>Set the properties: </p><pre>
$mail-&gt;setFrom('<a href="#" onclick="location.href='mai'+'lto:'+'fro'+'m@'+'exa'+'mp'+'le.'+'co'+'m'; return false;">from@<span style="display: none;">.nosp@m.</span>exam<span style="display: none;">.nosp@m.</span>ple.c<span style="display: none;">.nosp@m.</span>om</a>', 'John Doe');
$mail-&gt;setTo(Yii::app()-&gt;params['adminEmail']);
$mail-&gt;setSubject('Mail subject');
</pre><p> You may use all <a class="el" href="class_p_h_p_mailer.html">PHPMailer</a> properties you would usually use.</p>
<p>And finally send email(s): </p><pre>
if ($mail-&gt;send()) {
    Yii::app()-&gt;user-&gt;setFlash('contact','Thank you for contacting us. We will respond to you as soon as possible.');
} else {
    Yii::app()-&gt;user-&gt;setFlash('error','Error while sending email: '.$mail-&gt;getError());
}
</pre><h3>Sending simple messages</h3>
<p>You can send email without both the layout and view by using: </p><pre>
$mail = new <a class="el" href="class_yii_mailer.html">YiiMailer()</a>;
//$mail-&gt;clearLayout();//if layout is already set in config
$mail-&gt;setFrom('<a href="#" onclick="location.href='mai'+'lto:'+'fro'+'m@'+'exa'+'mp'+'le.'+'co'+'m'; return false;">from@<span style="display: none;">.nosp@m.</span>exam<span style="display: none;">.nosp@m.</span>ple.c<span style="display: none;">.nosp@m.</span>om</a>', 'John Doe');
$mail-&gt;setTo(Yii::app()-&gt;params['adminEmail']);
$mail-&gt;setSubject('Mail subject');
$mail-&gt;setBody('Simple message');
$mail-&gt;send();
</pre><p>Alternatively, you may also send email message with layout but without specific view (set layout and set body) or with view but without layout (clear layout and set view).</p>
<h3>Setting addresses</h3>
<p>When using methods for setting addresses (setTo(), setCc(), setBcc(), setReplyTo()) any of the following is valid for arguments: </p><pre>
$mail-&gt;setTo('<a href="#" onclick="location.href='mai'+'lto:'+'joh'+'n@'+'exa'+'mp'+'le.'+'co'+'m'; return false;">john@<span style="display: none;">.nosp@m.</span>exam<span style="display: none;">.nosp@m.</span>ple.c<span style="display: none;">.nosp@m.</span>om</a>');
$mail-&gt;setTo(array('<a href="#" onclick="location.href='mai'+'lto:'+'joh'+'n@'+'exa'+'mp'+'le.'+'co'+'m'; return false;">john@<span style="display: none;">.nosp@m.</span>exam<span style="display: none;">.nosp@m.</span>ple.c<span style="display: none;">.nosp@m.</span>om</a>','<a href="#" onclick="location.href='mai'+'lto:'+'jan'+'e@'+'exa'+'mp'+'le.'+'co'+'m'; return false;">jane@<span style="display: none;">.nosp@m.</span>exam<span style="display: none;">.nosp@m.</span>ple.c<span style="display: none;">.nosp@m.</span>om</a>'));
$mail-&gt;setTo(array('<a href="#" onclick="location.href='mai'+'lto:'+'joh'+'n@'+'exa'+'mp'+'le.'+'co'+'m'; return false;">john@<span style="display: none;">.nosp@m.</span>exam<span style="display: none;">.nosp@m.</span>ple.c<span style="display: none;">.nosp@m.</span>om</a>'=&gt;'John Doe','<a href="#" onclick="location.href='mai'+'lto:'+'jan'+'e@'+'exa'+'mp'+'le.'+'co'+'m'; return false;">jane@<span style="display: none;">.nosp@m.</span>exam<span style="display: none;">.nosp@m.</span>ple.c<span style="display: none;">.nosp@m.</span>om</a>'));
</pre><h3>Sending attachments</h3>
<p>You may send one or more attachments using setAttachemnt() method: </p><pre>
$mail-&gt;setAttachment('something.pdf');
$mail-&gt;setAttachment(array('something.pdf','something_else.pdf','another.doc'));
$mail-&gt;setAttachment(array('something.pdf'=&gt;'Some file','something_else.pdf'=&gt;'Another file'));
</pre><h3>Test mode</h3>
<p>When working locally without mail server installed, it may be useful to save emails as files instead of trying to send them and getting errors in the process. To use test mode, you must specify path to directory where you want to save your emails and set 'testMode' property to 'true' in your config:</p>
<pre>
    'savePath' =&gt; 'webroot.assets.mail',
    'testMode' =&gt; true,
</pre><p>Emails are saved as .eml files and you can use software like Mozilla Thunderbird to open them.</p>
<h3>Using <a class="el" href="class_s_m_t_p.html">SMTP</a></h3>
<p>If you want to use <a class="el" href="class_s_m_t_p.html">SMTP</a>, configure appropriate properties in your config. Example setup for GMail: </p><pre>
    'Mailer' =&gt; 'smtp',
    'Host' =&gt; 'smtp.gmail.com',
    'Port' =&gt; 465,
    'SMTPSecure' =&gt; 'ssl',
    'SMTPAuth' =&gt; true,
    'Username' =&gt; '<a href="#" onclick="location.href='mai'+'lto:'+'you'+'r_'+'ema'+'il'+'@gm'+'ai'+'l.c'+'om'; return false;">your_<span style="display: none;">.nosp@m.</span>emai<span style="display: none;">.nosp@m.</span>l@gma<span style="display: none;">.nosp@m.</span>il.c<span style="display: none;">.nosp@m.</span>om</a>',
    'Password' =&gt; 'your_password',
</pre><p>You may also configure this just before sending email: </p><pre>
$mail-&gt;setSmtp('smtp.gmail.com', 465, 'ssl', true, '<a href="#" onclick="location.href='mai'+'lto:'+'you'+'r_'+'ema'+'il'+'@gm'+'ai'+'l.c'+'om'; return false;">your_<span style="display: none;">.nosp@m.</span>emai<span style="display: none;">.nosp@m.</span>l@gma<span style="display: none;">.nosp@m.</span>il.c<span style="display: none;">.nosp@m.</span>om</a>', 'your_password');
</pre><h2>Examples</h2>
<p>Two examples included: one for standard contact form in yii web app and the other one for yii console app. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Створено системою &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
